#!/usr/bin/env coffee

console.info pathToEvent = process.argv[2]
CSON = require "cson"
FileSystem = require "fs"
Moment = require "moment"
Eco = require "eco"

template = FileSystem.readFileSync "event.html.eco", "UTF-8"
event = CSON.parseFileSync "#{pathToEvent}.cson"

event.date = Moment event.date
event.enHTML = "<p>" + event.en.replace(/\n\n/g, "</p><p>") + "</p>"
event.frHTML = "<p>" + event.fr.replace(/\n\n/g, "</p><p>") + "</p>"

console.info event
FileSystem.writeFileSync "#{pathToEvent}.html", Eco.render(template, {event}), "UTF-8"
